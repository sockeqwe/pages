<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>Hannes Dorfmann</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="From Prefab House to Lego House. A journey to why we should not use inheritance to create reusable screens and apps. How can we build reusable components?">
  <meta name="author" content="Hannes Dorfmann">
  <meta name="generator" content="Hugo 0.73.0" />
  <meta property='og:title' content='From Prefab House to Lego House'/>
  <meta property='og:description' content='From Prefab House to Lego House. A journey to why we should not use inheritance to create reusable screens and apps. How can we build reusable components?' />


  <!-- plugins -->
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/plugins/themify-icons/themify-icons.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/css/style.min.css" media="screen">

  <!-- Syntax highlightning Stylesheet -->
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/css/syntax-highlighting.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://hannesdorfmann.com/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://hannesdorfmann.com/images/favicon.png " type="image/x-icon">

  </head><body class="theme-light"><header class="navigation">
  <nav class="navbar navbar-expand-lg navbar-light">
    
    <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navogation"
      aria-controls="navogation" aria-expanded="false" aria-label="Toggle navigation">
      <span id="navbar-toggler" class="ti-menu"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navogation">
      <ul class="navbar-nav ml-auto">
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://hannesdorfmann.com">Home</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://hannesdorfmann.com/about">About</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://hannesdorfmann.com/presentations">Presentations</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://hannesdorfmann.com/contact">Contact</a>
        </li>
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" onclick="toggleTheme()">
            <img id="themeSwitcher" class="navbar-nav ml-lg-4" src="/images/theme/moon.svg"/>
          </a>
        </li>
      </ul>
      
      <!-- search -->
      <form class="form-inline position-relative ml-lg-4" action="https://hannesdorfmann.com/search">
        <input class="form-control px-0 w-100" type="search" placeholder="Search" id="search-query" name="s">
        <button class="search-icon" type="submit"><i class="ti-search text-dark"></i></button>
      </form>
      
    </div>
  </nav>
</header>


<section class="section bg-secondary">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h1>From Prefab House to Lego House</h1>
      </div>
    </div>
  </div>
</section>



<section>
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <ul class="list-inline d-flex justify-content-between py-3">
          <li class="list-inline-item"><i class="ti-user mr-2"></i>Post by Hannes Dorfmann</li>
          <li class="list-inline-item"><i class="ti-calendar mr-2"></i>May 13, 2016</li>
        </ul>
        <article class="content">
          
          <img src="https://hannesdorfmann.com/images/legohouse/legohouse.jpg" alt="post-thumb" class="img-fluid rounded float-left mr-5 mb-4">
          
          <p>Before joining my current employer I have worked for an app agency and one thing I have noticed is that we were building every app entirely new from scratch even if we were building a similar app for the same customer with similar UI. We hadn&rsquo;t reusable components. In this blog post I want to share some thoughts and lessons learned while building such reusable components.</p>
<p>At my current employer, <a href="https://www.tickaroo.com">Tickaroo</a>, we were facing the same situation three years ago. Although Tickaroo is not an app agency, it&rsquo;s a startup for sport enthusiasts, we are building apps for our partners from the world of sports as well. One of this partner is the <em>Olympia Verlag</em> , a renowned publisher in Germany for which we have started building (and are still developing and maintaining) their native android and iOS apps for one of their magazines called <a href="https://play.google.com/store/apps/details?id=com.netbiscuits.kicker">kicker</a> (football magazine, which displays football news, live updated and so on) three years ago.</p>
<p>After having released the first versions of the <a href="https://play.google.com/store/apps/details?id=com.netbiscuits.kicker">kicker</a> app successfully in 2013 the <em>Olympia Verlag</em> was pleased with our work and charged us with building another app called  <a href="https://play.google.com/store/apps/details?id=com.tickaroo.meinverein">MeinVerein</a>, also a football app where you can select your favorite football club and then the app displays news and games about your football club.</p>
<p>While kicker app is quite a huge app that can be used for free (with advertisement), MeinVerein is a paid only app (subscription based). MeinVerein&rsquo;s app functionality can be seen as some kind of subset from kicker app.</p>
<p>One thing was clear from the very beginning: since the same designer who already had designed the kicker app was going to design MeinVerein app too the UI should be quite similar for both apps. In fact, this was desired by our customer <em>Olympia Verlag</em> since they wanted to have a consistent design branding across all of their apps. Let&rsquo;s compare the UI of the apps:</p>
<p><img src="/images/legohouse/comparison.png" alt="UI comparison"></p>
<p>Basically MeinVerein app displays different data in more or less the same way as kicker app does with just some other colors / theme and the main navigation of both apps are different (navigation drawer vs. ViewPager). Some screens, for example the live updates screens, are completely identical. Other screens available in kicker app are not available in MeinVerein app. Additionally, MeinVerein offers some infos and screens kicker doesn&rsquo;t. Also, even if the UI seems pretty similar completely different actions and screens will be opened by for example clicking on a button. So MeinVerein should provide the same look and feel as kicker app, but you can&rsquo;t say that it is a simple build flavor / variant of the kicker app.</p>
<h2 id="lets-build-a-prefabricated-house">Let&rsquo;s build a prefabricated house</h2>
<p>Before we started with the development of MeinVerein app we, the iOS team and the android team, get together and discussed how we could build that app without much effort and in little time. The leading iOS developer, which by the way is the most experienced developer in our company, suggested to put all the stuff from the kicker app into a library. Software development is much about experience. Hence, it is priceless to have an experienced developers in your team and we from the android team had zero experience on how to build such a shared code base. He suggested to build a shared library as fundament for both, kicker app and MeinVerein app. So we did. The kicker app was build by using Fragments. Basically every screen is a Fragment, NewsListFragment to display a list of news, LeagueTableFragment etc. Furthermore, we have built this app by using <a href="http://hannesdorfmann.com/mosby/">Mosby</a> a Model-View-Presenter library and so we moved all Fragments (MVP View), RecyclerView Adapters, XML layouts, Presenters and Model classes from kicker app into the newly created shared library. kicker app&rsquo;s git repository was quite empty afterwards. For the sack of simplicity we only will discuss things in this blog post by using NewsListFragment as representative as a screen that looks similar in both apps, but keep in mind that there are also many other Fragments in this shared library.</p>
<p>The vision was to build screens for the corresponding apps by extending from the corresponding Fragment of the shared library that has already his Presenter, his RecyclerView Adapter, his XML layouts and so on. Customization should be done by overriding some methods from shared library&rsquo;s Fragment, coloring and theming in xml and if required provide a custom dagger module to inject non default app specific components via dependency injection. The iOS team did the same with their UIViewControllers etc. In a nutshell: We built a prefabricated house where we can specify the color of the walls.</p>
<h2 id="the-problems-of-our-prefabricated-house">The problems of our prefabricated house</h2>
<p>Thanks to the shared library we were able to ship MeinVerein app within a few weeks. Everything was good. But we noticed the first symptoms: We caught ourselves programming 90% of the time in the shared library project even though that the actually code we were writing was kicker app exclusively and not even used by MeinVerein. But we ignored those symptoms: We use proguard which will remove all the unused classes from shared library in MeinVerein app or kicker app respectively, right?</p>
<p>Another example: We decided to put all our model classes and http networking stuff in the library as well, because even if the backend is not the same (different url) the backend guys said to us that the json data feed structure will be the same. At least that was the case in the first version of MeinVerein but as time went by and more features had been implemented the data feeds for both backends begin to differ more and more. However, imho the real problem was that all the pitfalls and issues on kicker backend side regarding json feed structure had also been copied to MeinVerein backend instead of avoiding this issues from very beginning since MeinVerein backend was a greenfield. But you know, we had to move fast, so had the backend guys. Today I know: you don&rsquo;t move fast by writing bad code.</p>
<p>Overall our shared library looks like this, i.e. to load and display a list of news items (NewsListFragment):</p>
<p><img src="/images/legohouse/NewsListFragment.png" alt="NewsListFragment"></p>
<p>Basically we used <em>NewsListFragment</em> directly in kicker app and <em>MVNewsListFragment extends NewsListFragment</em> in MeinVerein app with some overridden methods to achieve our goals. Looks reasonable, doesn&rsquo;t it?</p>
<p>Unfortunately, the devil is in the detail. While kicker app has advertisement, MeinVerein app has not advertisement because it&rsquo;s a paid app. Also some features available in kicker App are not available MeinVerein app.</p>
<p><img src="/images/legohouse/no-advertisement-feature.png" alt="No advertisement"></p>
<p>Those are just two of many UI differences between both apps that has been envoled over the time.
Sure, it&rsquo;s our fault because the inheritance hierarchy is incorrect: The shared library shouldn&rsquo;t provide a NewsListFragment with advertisement and feature XY build in but there should be rather a <em>AdvertismentNewsListFragment extends NewsListFragment</em> in the kicker app only, right?
A few months later we started building a new app called &ldquo;Tippspiel app&rdquo; also for <em>Olympia Verlag</em> that looks like this:</p>
<p><img src="/images/legohouse/kicker-meinverein-tippspiel.png" alt="Tippspiel"></p>
<p>Tippspiel looks similar to kicker and MeinVerein app. Actually, is uses the same <em>NewsListFragment</em>. However, apart from displaying a list of news in the same way as kicker and MeinVerein this app has nothing in common with the other apps. Tippspiel app has advertisement in the NewsList but not the feature XY. So what actually should <em>NewsListFragment</em> provide? Clearly we should introduce a inheritance hierarchy like this:</p>
<p><img src="/images/legohouse/inheritance-newslistfragment.png" alt="Tippspiel"></p>
<p>So should we put <em>NewsListFragment</em>, <em>AdvertisementNewsListFragment</em>, <em>FeatureXYNewsListFragment</em> and <em>AdvertismenetFeatureXYNewsListFragment</em> into the shared library so that we can choose the right base class that matches the requirements for the app like MeinVerein <em>MVNewsListFragment extends NewsListFragment</em> (no advertisement, no feature XY), kicker <em>KikNewsListFragment extends AdvertismenetFeatureXYNewsListFragment</em> (advertisement and feature XY) and Tippspiel <em>TPNewsListFragment extends AdvertisementNewsListFragment</em>(advertiesment only)? You see, inheritance doesn&rsquo;t solve that problem, because for each feature you would have to introduce a new class in your inheriatance hierarchy and there are so many possible combinations for advertisement support, feature A, feature B, feature XY etc. Single inheritance as in java doesn&rsquo;t scale. I have written an blog post <a href="http://hannesdorfmann.com/android/java-mixins">Mixins as alternative to inheritance</a> that you may find useful in this context.</p>
<p>But wait &hellip; there is more: lately we have worked on the newest member of <em>Olympia Verlag</em> apps called Nordbayern app (another magazine):</p>
<p><img src="/images/legohouse/kicker-meinverein-tippspiel-nordbayern.png" alt="Tippspiel"></p>
<p>So we decided to keep one single <em>NewsListFragment</em> in the shared library that has advertisement support and all features already implemented. Our solution for that problem was to extend from the &ldquo;super provide everything NewsListFragment&rdquo; but then inject a feature XY component that does nothing (stub) via dagger if the feature XY is not supported in the app. For Example, MeinVerein App doesn&rsquo;t have feature XY, so we injected a featureXY component that does nothing in MeinVerein app whereas kicker app uses the build in feature XY component that does something useful. We thought about this as some kind of workaround to &ldquo;remove unused&rdquo; functionality. That made our shared libraries code confusing and debugging wasn&rsquo;t easy because you didn&rsquo;t know if a invoked method of a feature component does something useful or is just a stub. But we hadn&rsquo;t a better solution.</p>
<p>But wait &hellip; there is more: When we started to build our prefabricated house (a.k.a shared library) we were under the very naive illusion that now we only have to write one unit test for the <em>NewsListFragment</em> from shared library once for all apps and also if we would detect a bug in NewsListFragment we would fix it once for all apps. The reality was quite the opposite. Since, every app extended from <em>NewsListFragment</em> but has overridden some methods in the concrete apps fragment, we couldn&rsquo;t be sure that the bugfix really fixed the problem in all apps and that the fragment is working as expected. Moreover, with every change or new feature we added to shared library&rsquo;s <em>NewsListFragment</em> we had to fear that this will break things in other apps extending from this fragment. Our daily work flow was something like this: Write some code in share library (~ 10 minutes of work), test that each app is still working properly (~ 10 minutes of work for each app thanks to gradle incredible fast build time). So we spent around 1 hour for a code change doable in 10 minutes.</p>
<p>But wait &hellip; there is more: until now we only talked about UI related things. But there are some other stuff like Tracking which are tight to lifecycle, one app has multiple tracking for some strange reason, another app uses an advertisement sdk which is also lifecycle aware and you have to call some methods like <em>advertismentView.stop()</em> in <em>Fragment.onDestroyView()</em> etc. Put all those things and dependencies into <em>NewsListFragment</em> in shared lib? It was a nightmare.</p>
<h2 id="the-need-of-a-lego-kit">The need of a Lego kit</h2>
<p>We from the android team decided to take on this problem. Things got completely out of hand and we were slowed down by our shared library which actually should help us go fast. To be fair, when we started with the shared library it wasn&rsquo;t predictable that we were going to build so many apps based on this shared library in the future and that requirements and features were that completely different from app to app.</p>
<p>We started to brainstorm and we made an interesting observation: Actually, writing a Presenter is super easy and can be done within a few minutes. So let&rsquo;s remove the Presenters from shared library and let every app have their own Presenters. The same is true for our http library: communicating with a backend with Retrofit just requires to define a service interface with some Retrofit annotations. That takes only a few minutes. Also the &ldquo;Model&rdquo; classes like <em>NewsList</em> were part of the shared library. Defining your own Model class for each app is not a huge deal and is also not really time intensive. Obviously, those things (Presenter, http and &ldquo;model&rdquo; classes) weren&rsquo;t the biggest issue, but removing that from shared library pointed us towards to a general solution: Only keep that things in a shared library that are time intensive to code again and again. We came to the conclusion that the most time consuming thing for us was writing RecyclerView ViewHolders and corresponding XML layout files. Also, time intensive was to implement all the lifecycle aware stuff like tracking and so on and <strong>NOT</strong> implementing a Fragment or Activity class per se.</p>
<p>Once we realized that the solution was obvious: We don&rsquo;t want to build a prefabricated house, we want to build a Lego house with only those Lego pieces we really need for that house / app. In other words: we needed a <strong>Lego kit</strong> containing ViewHolders and XML layouts and also a plugin mechanism to hook in tracking and advertisement into Fragment&rsquo;s lifecycle.</p>
<p>So we decided to deprecate the shared library and build two libraries: One containing ViewHolders, one containing plugin components for lifecycle. Another thing was very clear to us:</p>
<blockquote>
<p>Favor composition over inheritance
We didn&rsquo;t wanted to make the same mistake again: a god alike <em>NewsListFragment</em> to extend from.</p>
</blockquote>
<p>First, let&rsquo;s talk about how we decided to deal with <em>ViewHolder</em>. Well, there is a library of mine which I have build in this context called <a href="https://github.com/sockeqwe/AdapterDelegates">AdapterDelegates</a>. The idea is simple: defining a delegate for each RecyclerView&rsquo;s ViewType / ViewHolder which does the job of inflating xml layout and binding the data:</p>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin"> <span class="k">public</span> <span class="k">class</span> <span class="nc">BigNewsItemAdapterDelegate</span> <span class="n">extends</span> <span class="n">AbsListItemAdapterDelegate</span><span class="p">&lt;</span><span class="n">BigNewsItem</span><span class="p">,</span> <span class="n">NewsViewHolder</span><span class="p">&gt;</span> <span class="p">{</span>

     <span class="n">@Override</span> <span class="k">public</span> <span class="n">NewsViewHolder</span> <span class="n">onCreateViewHolder</span><span class="p">(</span><span class="n">ViewGroup</span> <span class="n">parent</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">return</span> <span class="n">new</span> <span class="n">CatViewHolder</span><span class="p">(</span><span class="n">inflater</span><span class="p">.</span><span class="n">inflate</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="n">layout</span><span class="p">.</span><span class="n">item_cat</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="k">false</span><span class="p">));</span>
     <span class="p">}</span>

     <span class="n">@Override</span> <span class="k">public</span> <span class="n">void</span> <span class="n">onBindViewHolder</span><span class="p">(</span><span class="n">BigNewsItem</span> <span class="n">item</span><span class="p">,</span> <span class="n">NewsViewHolder</span> <span class="n">vh</span><span class="p">)</span> <span class="p">{</span>
       <span class="n">vh</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">getTitle</span><span class="p">());</span>
       <span class="n">loadImage</span><span class="p">(</span><span class="n">vh</span><span class="p">.</span><span class="n">image</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">getImageUrl</span><span class="p">());</span>
     <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>So we defined all those AdapterDelegates like <em>BigNewsItemAdapterDelegate</em>,  <em>VideoNewsItemDelegate</em>, <em>SlideshowNewsItemDelegate</em> etc. and put them in a library.</p>
<p>Now kicker&rsquo;s <em>KikNewsListFragment</em> looks like this:</p>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="n">@Override</span>
<span class="k">public</span> <span class="n">void</span> <span class="n">onCreateView</span><span class="p">(</span><span class="n">LayoutInflater</span> <span class="n">inflater</span><span class="p">,</span> <span class="n">ViewGroup</span> <span class="n">parent</span><span class="p">,</span> <span class="n">Bundle</span> <span class="n">b</span><span class="p">){</span>
    <span class="p">...</span>
    <span class="n">RecyclerView</span> <span class="n">rv</span> <span class="p">=</span>  <span class="p">...;</span>

    <span class="n">Adapter</span> <span class="n">adapter</span> <span class="p">=</span> <span class="n">new</span> <span class="n">DelegatingAdapter</span><span class="p">&lt;</span><span class="n">NewsItem</span><span class="p">&gt;();</span>
    <span class="n">adapter</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">BigNewsItemAdapterDelegate</span><span class="p">())</span>
           <span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">VideoNewsItemDelegate</span><span class="p">())</span>
           <span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">SlideshowNewsItemDelegate</span><span class="p">())</span>
           <span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">AdvertisementDelegate</span><span class="p">());</span>

   <span class="n">rv</span><span class="p">.</span><span class="n">setAdapter</span><span class="p">(</span><span class="n">adapter</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>Please note that the <em>AdvertisementDelegate()</em> is not part of the library, because this one is used in kicker app and but not in MeinVerein app. I guess you know how the code of Fragments of the other apps  look like, right? They reuse the same AdapterDelegates, the same xml layouts etc. However, to be really independent every AdapterDelegate has a tiny companion class for holding the required data to be displayed in a ViewHolder as well, i.e. <em>BigNewsItemAdapterDelegate</em> has a <em>BigNewsItem</em>, <em>VideoNewsItemDelegate</em> has a <em>VideoNewsItem</em> and so on.</p>
<p>So at some point we have to map the data coming from backend to this companion object. This is where a MVP based App pays of. This is the responsibility of the Presenter. We transform the &ldquo;model&rdquo; into a &ldquo;presentation model&rdquo;. Overall the architecture looks like this:</p>
<p><img src="/images/legohouse/adpterdeleages-architecture.png" alt="Tippspiel"></p>
<p>And for the Tracking stuff? Favor composition over inheritance!</p>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">interface</span> <span class="nc">LifecycleDelegate</span> <span class="p">{</span>
  <span class="n">void</span> <span class="n">onCreate</span><span class="p">();</span>
  <span class="n">void</span> <span class="n">onPause</span><span class="p">();</span>
  <span class="n">void</span> <span class="n">onResume</span><span class="p">();</span>
  <span class="n">void</span> <span class="n">onDestroy</span><span class="p">();</span>
  <span class="p">...</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">TrackingLifecycleDelegate</span> <span class="n">implements</span> <span class="n">LifecycleDelegate</span> <span class="p">{</span>
  <span class="k">private</span> <span class="n">String</span> <span class="n">trackingTag</span><span class="p">;</span>
  <span class="k">public</span> <span class="n">TrackingLifecycleDelegate</span><span class="p">(</span><span class="n">String</span> <span class="n">trackingTag</span><span class="p">){</span>
     <span class="k">this</span><span class="p">.</span><span class="n">trackingTag</span> <span class="p">=</span> <span class="n">trackingTag</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">@Override</span>
  <span class="k">public</span> <span class="n">void</span> <span class="n">onResume</span><span class="p">(){</span>
    <span class="n">Tracking</span><span class="p">.</span><span class="n">viewAppeared</span><span class="p">(</span><span class="n">trackingTag</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">...</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">KikNewsListFragment</span> <span class="n">extends</span> <span class="n">Fragment</span> <span class="p">{</span>

  <span class="n">List</span><span class="p">&lt;</span><span class="n">LifecycleDelegate</span><span class="p">&gt;</span> <span class="n">lifecycleDelegates</span> <span class="p">=</span> <span class="n">new</span> <span class="n">ArrayList</span><span class="p">&lt;&gt;();</span>

  <span class="p">{</span> <span class="c1">// Initializer block
</span><span class="c1"></span>    <span class="n">lifecycleDelegates</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">new</span> <span class="n">TrackingLifecycleDelegate</span><span class="p">(</span><span class="s">&#34;kicker app NewsListScreen&#34;</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="n">@Override</span>
  <span class="k">public</span> <span class="n">void</span> <span class="n">onResume</span><span class="p">(){</span>
    <span class="k">super</span><span class="p">.</span><span class="n">onResume</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">LifecycleDelegate</span> <span class="n">l</span> <span class="p">:</span> <span class="n">lifecycleDelegates</span><span class="p">){</span>
      <span class="n">lifecycleDelegates</span><span class="p">.</span><span class="n">onResume</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Same for other lifecycle methods
</span><span class="c1"></span>  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div><p>Now we can share <em>TrackingLifecycleDelegate</em> with all apps. Overall it looks like this:</p>
<p><img src="/images/legohouse/alldelegates-architecture.png" alt="Tippspiel"></p>
<p>There are some libraries you can use to achieve the same thing: Soundcloud&rsquo;s <a href="https://github.com/soundcloud/lightcycle">Lightcycle</a> and <a href="https://github.com/passsy/CompositeAndroid">AndroidComposite</a> by  Pascal Welsch.</p>
<h2 id="summary">Summary</h2>
<p>In my opinion a Lego house is much more flexible and maintainable compared with a prefabricated house. Favor composition over inheritance is the key to build a Lego kit. Obviously, there is no silver bullet to solve that kind of problem. Our Lego house approach works quite good for us, but i.e. our  iOS team still prefer the prefabricated house approach even though they have similar issues as we had in our android apps. Somehow that approach works for them (but don&rsquo;t ask me how). I guess the important bit is that all developers working in the same team know exactly how this approach should be implemented and have committed to do that consistently the same way. Maybe we from the android team failed at this point.</p>
<p>Was it an error to start with the prefabricated house approach suggested by the most experienced developer in our company? No! MeinVerein app has been build with that approach in incredible little time. I definitely would follow the experienced developers recommendation again, but not blindly. I have learned a lot, which hopefully will help me with future decisions. What really matters is to learn from the past to build a better future. I think with the Lego house approach we are moving in the right direction. But who knows, maybe in two years I will write a blog post about how bad the Lego house approach was.</p>

        </article>
      </div>
      
    </div>
  </div>
</section>

<section>
    <div class="container">
        <div class="row justify-content-md-center">

            <div class="share-post-box">

                <a class="text-dark"
                    href="https://twitter.com/intent/tweet?text=&quot;From%20Prefab%20House%20to%20Lego%20House&quot;%20https%3a%2f%2fhannesdorfmann.com%2fandroid%2ffrom-prefabricated-house-to-lego-house%2f%20via%20@sockeqwe"
                    target="_blank" title="Share on Twitter"><i class="ti-twitter-alt share-icon"></i></a>

                <a class="text-dark" href="http://www.reddit.com/submit?url=https%3a%2f%2fhannesdorfmann.com%2fandroid%2ffrom-prefabricated-house-to-lego-house%2f&title=From%20Prefab%20House%20to%20Lego%20House"
                    target="_blank" title="Share on Reddit"><i class="ti-reddit share-icon"></i></a>


                <a class="text-dark" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fhannesdorfmann.com%2fandroid%2ffrom-prefabricated-house-to-lego-house%2f"
                    target="_blank" title="Share on LinkedIn"><i class="ti-linkedin share-icon"></i></a>

            </div>
        </div>
    </div>
</section>

<section>
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="widget">
  <h4 class="mb-4">LATEST POSTS</h4>
  
  <div class="media mb-4">
    <div class="media-body">
      <ul class="list-inline d-flex justify-content-between mb-2">
        <li class="list-inline-item">Jan 29, 2021</li>
      </ul>
      <h6><a class="text-dark" href="https://hannesdorfmann.com/perfectionism-vs-excellence/">Perfectionism vs. Excellence</a></h6>
    </div>
  </div>
  
  <div class="media mb-4">
    <div class="media-body">
      <ul class="list-inline d-flex justify-content-between mb-2">
        <li class="list-inline-item">Jan 22, 2021</li>
      </ul>
      <h6><a class="text-dark" href="https://hannesdorfmann.com/abstraction-text-resource/">Finding the right abstraction (when working with Strings)</a></h6>
    </div>
  </div>
  
  <div class="media mb-4">
    <div class="media-body">
      <ul class="list-inline d-flex justify-content-between mb-2">
        <li class="list-inline-item">May 06, 2018</li>
      </ul>
      <h6><a class="text-dark" href="https://hannesdorfmann.com/android/mosby3-mvi-8/">Reactive Apps with Model-View-Intent - Part 8: Navigation</a></h6>
    </div>
  </div>
  
</div>
      </div>
    </div>
  </div>
</section>


<footer class="bg-secondary">
  <div class="section">
    <div class="container">
      <div class="row">
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          
              <h6>Copyright &copy; 2022 <br /> Hannes Dorfmann</h6>
              <small>Theme based on hugo-parsa.</small>
        </div>
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          <h6>Categories in this Blog</h6>
          
          <ul class="list-inline tag-list">
            <li class="list-inline-item m-1"><a
                href="/categories/android">Android</a>
            </li>
            <li class="list-inline-item m-1"><a
                href="/categories/annotation-processor">Annotation-Processor</a>
            </li>
            <li class="list-inline-item m-1"><a
                href="/categories/java">Java</a>
            </li>
            <li class="list-inline-item m-1"><a
                href="/categories/soft-skills">Soft-Skills</a>
            </li>
          </ul>

        </div>
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          <h6>Tags in this Blog</h6>
          
          <ul class="list-inline tag-list">
            <li class="list-inline-item m-1"><a
                href="/tags/algorithms">algorithms</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/android">android</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/code-review">code-review</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/database">database</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/design-patterns">design-patterns</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/java">java</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/library">library</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/navigation">navigation</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/software-architecture">software-architecture</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/ui">ui</a></li>
            <li class="list-inline-item m-1"><a
                href="/tags/ux">ux</a></li>
          </ul>
        </div>
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          <h6>Follow</h6>
          <ul class="list-inline d-inline-block">
            
            <li class="list-inline-item"><a href="https://twitter.com/sockeqwe" class="text-dark"><i class="ti-twitter-alt"></i></a></li>
            
            <li class="list-inline-item"><a href="https://github.com/sockeqwe/" class="text-dark"><i class="ti-github"></i></a></li>
            
            <li class="list-inline-item"><a href="https://hannesdorfmann.com/index.xml" class="text-dark"><i class="ti-rss"></i></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
</footer>



<script>
  var indexURL = "https://hannesdorfmann.com/index.json"
</script>


<!-- JS Plugins -->

<script src="https://hannesdorfmann.com/plugins/jQuery/jquery.min.js"></script>

<script src="https://hannesdorfmann.com/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://hannesdorfmann.com/plugins/slick/slick.min.js"></script>

<script src="https://hannesdorfmann.com/plugins/headroom/headroom.js"></script>

<script src="https://hannesdorfmann.com/plugins/masonry/masonry.js"></script>

<script src="https://hannesdorfmann.com/plugins/smooth-scroll/smooth-scroll.js"></script>

<script src="https://hannesdorfmann.com/plugins/search/fuse.min.js"></script>

<script src="https://hannesdorfmann.com/plugins/search/mark.js"></script>

<script src="https://hannesdorfmann.com/plugins/search/search.js"></script>


<!-- Main Script -->

<script src="https://hannesdorfmann.com/js/script.min.js"></script>

<!-- google analitycs -->

<script>
  (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date(); a = s.createElement(o),
      m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
  })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
  ga('create', 'UA-54945521-1', 'auto');
  ga('send', 'pageview');
</script>





<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
  This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button"
    class="btn btn-sm btn-outline-light ml-2">I Accept</span>
</div>
<script>
  (function ($) {
    const cookieBox = document.getElementById('js-cookie-box');
    const cookieButton = document.getElementById('js-cookie-button');
    if (!Cookies.get('cookie-box')) {
      cookieBox.classList.remove('cookie-box-hide');
      cookieButton.onclick = function () {
        Cookies.set('cookie-box', true, {
          expires:  365 
    });
    cookieBox.classList.add('cookie-box-hide');
  };
		}
	}) (jQuery);
</script>


<style>
  .cookie-box {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    text-align: center;
    z-index: 9999;
    padding: 1rem 2rem;
    background: rgb(71, 71, 71);
    transition: all .75s cubic-bezier(.19, 1, .22, 1);
    color: #fdfdfd;
  }

  .cookie-box-hide {
    display: none;
  }
</style>
<script data-goatcounter="https://hannesdorfmann.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
    </body>
</html>