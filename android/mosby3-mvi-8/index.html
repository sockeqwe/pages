<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>Hannes Dorfmann</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Model-View-Intent MVI on Android by using Mosby 3. Navigation in MVI.">
  <meta name="author" content="Hannes Dorfmann">
  <meta name="generator" content="Hugo 0.73.0" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/pages/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/pages/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/pages/plugins/themify-icons/themify-icons.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/pages/css/style.min.css" media="screen">

  <!-- Syntax highlightning Stylesheet -->
  
  <link rel="stylesheet" href="https://hannesdorfmann.com/pages/css/syntax-highlighting.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://hannesdorfmann.com/pages/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://hannesdorfmann.com/pages/images/favicon.png " type="image/x-icon">

  </head><body class="theme-light">
<!-- preloader start -->
<div class="preloader">
  <div class="loader">
    <span class="dot"></span>
    <div class="dots">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
</div>
<!-- preloader end -->
<header class="navigation">
  <nav class="navbar navbar-expand-lg navbar-light">
    
    <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navogation"
      aria-controls="navogation" aria-expanded="false" aria-label="Toggle navigation">
      <span id="navbar-toggler" class="ti-menu"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navogation">
      <ul class="navbar-nav ml-auto">
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://hannesdorfmann.com/pages/">Home</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://hannesdorfmann.com/pages/about">About</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://hannesdorfmann.com/pages/presentations">Presentations</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" href="https://hannesdorfmann.com/pages/contact">Contact</a>
        </li>
        
        
        <li class="nav-item">
          <a class="nav-link text-uppercase text-dark" onclick="toggleTheme()">
            <img id="themeSwitcher" class="navbar-nav ml-lg-4" src="/images/theme/moon.svg"/>
          </a>
        </li>
      </ul>
      
      <!-- search -->
      <form class="form-inline position-relative ml-lg-4" action="https://hannesdorfmann.com/pages//search">
        <input class="form-control px-0 w-100" type="search" placeholder="Search" id="search-query" name="s">
        <button class="search-icon" type="submit"><i class="ti-search text-dark"></i></button>
      </form>
      
    </div>
  </nav>
</header>


<section class="section bg-secondary">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h1>Reactive Apps with Model-View-Intent - Part 8: Navigation</h1>
      </div>
    </div>
  </div>
</section>



<section>
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <ul class="list-inline d-flex justify-content-between py-3">
          <li class="list-inline-item"><i class="ti-user mr-2"></i>Post by Hannes Dorfmann</li>
          <li class="list-inline-item"><i class="ti-calendar mr-2"></i>May 06, 2018</li>
        </ul>
        <article class="content">
          
          <p>In my <a href="https://hannesdorfmann.com/pages/android/coordinators-android/">previous blog post</a> we discussed how the Coordinator pattern can be applied on Android. This time I would like to show how this can be used in Model-View-Intent.</p>
<p>If you don&rsquo;t know yet what the Coordinator pattern is I highly recommend to go back and read the <a href="https://hannesdorfmann.com/pages/android/coordinators-android/">introdcution</a>.</p>
<p>Applying this pattern in MVI is not much different from MVVM or MVP:
we pass a lambda as navigation callback into our MviBasePresenter.
The interesting part is how do we trigger this callbacks in a state driven architecture?
Let&rsquo;s take a look at a concrete example:</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nf">FooPresenter</span><span class="o">(</span>
  <span class="kd">private</span> <span class="n">var</span> <span class="n">navigationCallback</span><span class="o">:</span> <span class="o">(</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">Unit</span> <span class="o">)?</span>
<span class="o">)</span> <span class="o">:</span> <span class="n">MviBasePresenter</span><span class="o">&lt;</span><span class="n">FooView</span><span class="o">&gt;</span> <span class="o">{</span>  
  <span class="n">lateinit</span> <span class="n">var</span> <span class="n">disposable</span> <span class="o">:</span> <span class="n">Disposable</span>
  <span class="n">override</span> <span class="n">fun</span> <span class="nf">bindIntents</span><span class="o">(){</span>
    <span class="n">val</span> <span class="n">intent1</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">val</span> <span class="n">intent2</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">val</span> <span class="n">intents</span> <span class="o">=</span> <span class="n">Observable</span><span class="o">.</span><span class="na">merge</span><span class="o">(</span><span class="n">intent1</span><span class="o">,</span> <span class="n">intent2</span><span class="o">)</span>

    <span class="n">val</span> <span class="n">state</span> <span class="o">=</span> <span class="n">intents</span><span class="o">.</span><span class="na">switchMap</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>

    <span class="c1">// Here stars the interesting part
</span><span class="c1"></span>    <span class="n">val</span> <span class="n">sharedState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="na">share</span><span class="o">()</span>
    <span class="n">disposable</span> <span class="o">=</span> <span class="n">sharedState</span><span class="o">.</span><span class="na">filter</span><span class="o">{</span> <span class="n">state</span> <span class="o">-&gt;</span>
      <span class="n">state</span> <span class="n">is</span> <span class="n">State</span><span class="o">.</span><span class="na">Foo</span>
    <span class="o">}.</span><span class="na">subscribe</span> <span class="o">{</span> <span class="n">navigationCallback</span><span class="o">!!()</span> <span class="o">}</span>
  
    <span class="n">subscribeViewState</span><span class="o">(</span><span class="n">sharedState</span><span class="o">,</span> <span class="n">FooView</span><span class="o">::</span><span class="n">render</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="n">override</span> <span class="n">fun</span> <span class="nf">unbindIntents</span><span class="o">(){</span>
    <span class="n">disposable</span><span class="o">.</span><span class="na">dispose</span><span class="o">()</span> <span class="c1">// Navigation disposable
</span><span class="c1"></span>    <span class="n">navigationCallback</span> <span class="o">=</span> <span class="kc">null</span> <span class="c1">// Avoid memory leaks
</span><span class="c1"></span>  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p>The idea is to reuse the same <code>state</code> observable that we usually use to render the state in our View by using RxJava&rsquo;s <code>share()</code> operator.
This plus the combination of <code>.filter()</code> allows us to listen for a certain state and then trigger the navigation once we reached that state.
The Coordinator Pattern then just works as described in my previous blog post.</p>

    
    <div class="series-box">
        <h5>This is a post in the 
        <u>Reactive Apps with Model-View-Intent</u> series.</span></h5>
        <p>Other posts in this series:</p>

        
        
        <ul>
        
            <li>
                <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-1/">Reactive Apps with Model-View-Intent - Part 1: Model</a>
            </li>
        
            <li>
                <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-2/">Reactive Apps with Model-View-Intent - Part 2: View and Intent</a>
            </li>
        
            <li>
                <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-3/">Reactive Apps with Model-View-Intent - Part 3: State Reducer</a>
            </li>
        
            <li>
                <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-4/">Reactive Apps with Model-View-Intent - Part 4: Independent UI Components</a>
            </li>
        
            <li>
                <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-5/">Reactive Apps with Model-View-Intent - Part 5: Debugging with ease</a>
            </li>
        
            <li>
                <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-6/">Reactive Apps with Model-View-Intent - Part 6: Restoring State</a>
            </li>
        
            <li>
                <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-7/">Reactive Apps with Model-View-Intent - Part 7: Timing (SingleLiveEvent problem)</a>
            </li>
        
            <li>
                <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-8/">Reactive Apps with Model-View-Intent - Part 8: Navigation</a>
            </li>
        
        </ul>
    </div>
 

        </article>
      </div>
      
    </div>
  </div>
</section>
<section>
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="widget">
  <h4 class="mb-4">LATEST POSTS</h4>
  
  <div class="media mb-4">
    <div class="post-thumb-sm mr-3">
      <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-8/"><img class="mr-3 post-thumb-sm" src="https://hannesdorfmann.com/pages/"></a>
    </div>
    <div class="media-body">
      <ul class="list-inline d-flex justify-content-between mb-2">
        <li class="list-inline-item">May 06, 2018</li>
      </ul>
      <h6><a class="text-dark" href="https://hannesdorfmann.com/pages/android/mosby3-mvi-8/">Reactive Apps with Model-View-Intent - Part 8: Navigation</a></h6>
    </div>
  </div>
  
  <div class="media mb-4">
    <div class="post-thumb-sm mr-3">
      <a href="https://hannesdorfmann.com/pages/android/coordinators-android/"><img class="mr-3 post-thumb-sm" src="https://hannesdorfmann.com/pages/"></a>
    </div>
    <div class="media-body">
      <ul class="list-inline d-flex justify-content-between mb-2">
        <li class="list-inline-item">May 05, 2018</li>
      </ul>
      <h6><a class="text-dark" href="https://hannesdorfmann.com/pages/android/coordinators-android/">In-App Navigation with Coordinators</a></h6>
    </div>
  </div>
  
  <div class="media mb-4">
    <div class="post-thumb-sm mr-3">
      <a href="https://hannesdorfmann.com/pages/android/mosby3-mvi-7/"><img class="mr-3 post-thumb-sm" src="https://hannesdorfmann.com/pages/"></a>
    </div>
    <div class="media-body">
      <ul class="list-inline d-flex justify-content-between mb-2">
        <li class="list-inline-item">Sep 13, 2017</li>
      </ul>
      <h6><a class="text-dark" href="https://hannesdorfmann.com/pages/android/mosby3-mvi-7/">Reactive Apps with Model-View-Intent - Part 7: Timing (SingleLiveEvent problem)</a></h6>
    </div>
  </div>
  
</div>
      </div>
    </div>
  </div>
</section>


<footer class="bg-secondary">
  <div class="section">
    <div class="container">
      <div class="row">
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          
              <h6>Copyright &copy; 2021 <br /> Hannes Dorfmann</h6>
              <small>Theme by themefisher.com</small>
        </div>
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          <h6>Categories in this Blog</h6>
          
          <ul class="list-inline tag-list">
            <li class="list-inline-item m-1"><a
                href="/pages/categories/android">Android</a>
            </li>
            <li class="list-inline-item m-1"><a
                href="/pages/categories/annotation-processor">Annotation-Processor</a>
            </li>
            <li class="list-inline-item m-1"><a
                href="/pages/categories/java">Java</a>
            </li>
          </ul>

        </div>
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          <h6>Tags in this Blog</h6>
          
          <ul class="list-inline tag-list">
            <li class="list-inline-item m-1"><a
                href="/pages/tags/algorithms">algorithms</a></li>
            <li class="list-inline-item m-1"><a
                href="/pages/tags/android">android</a></li>
            <li class="list-inline-item m-1"><a
                href="/pages/tags/database">database</a></li>
            <li class="list-inline-item m-1"><a
                href="/pages/tags/design-patterns">design-patterns</a></li>
            <li class="list-inline-item m-1"><a
                href="/pages/tags/java">java</a></li>
            <li class="list-inline-item m-1"><a
                href="/pages/tags/library">library</a></li>
            <li class="list-inline-item m-1"><a
                href="/pages/tags/navigation">navigation</a></li>
            <li class="list-inline-item m-1"><a
                href="/pages/tags/software-architecture">software-architecture</a></li>
            <li class="list-inline-item m-1"><a
                href="/pages/tags/ui">ui</a></li>
            <li class="list-inline-item m-1"><a
                href="/pages/tags/ux">ux</a></li>
          </ul>
        </div>
        <div class="col-md-3 col-sm-6 mb-4 mb-md-0">
          <h6>Follow</h6>
          <ul class="list-inline d-inline-block">
            
            <li class="list-inline-item"><a href="" class="text-dark"><i class="ti-twitter-alt"></i></a></li>
            
            <li class="list-inline-item"><a href="" class="text-dark"><i class="ti-github"></i></a></li>
            
            <li class="list-inline-item"><a href="https://hannesdorfmann.com/pages//index.xml" class="text-dark"><i class="ti-rss"></i></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
</footer>



<script>
  var indexURL = "https://hannesdorfmann.com/pages/index.json"
</script>


<!-- JS Plugins -->

<script src="https://hannesdorfmann.com/pages/plugins/jQuery/jquery.min.js"></script>

<script src="https://hannesdorfmann.com/pages/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://hannesdorfmann.com/pages/plugins/slick/slick.min.js"></script>

<script src="https://hannesdorfmann.com/pages/plugins/headroom/headroom.js"></script>

<script src="https://hannesdorfmann.com/pages/plugins/masonry/masonry.js"></script>

<script src="https://hannesdorfmann.com/pages/plugins/smooth-scroll/smooth-scroll.js"></script>

<script src="https://hannesdorfmann.com/pages/plugins/search/fuse.min.js"></script>

<script src="https://hannesdorfmann.com/pages/plugins/search/mark.js"></script>

<script src="https://hannesdorfmann.com/pages/plugins/search/search.js"></script>


<!-- Main Script -->

<script src="https://hannesdorfmann.com/pages/js/script.min.js"></script>

<!-- google analitycs -->

<script>
  (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date(); a = s.createElement(o),
      m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
  })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
  ga('create', 'Your ID', 'auto');
  ga('send', 'pageview');
</script>





<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
  This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button"
    class="btn btn-sm btn-outline-light ml-2">I Accept</span>
</div>
<script>
  (function ($) {
    const cookieBox = document.getElementById('js-cookie-box');
    const cookieButton = document.getElementById('js-cookie-button');
    if (!Cookies.get('cookie-box')) {
      cookieBox.classList.remove('cookie-box-hide');
      cookieButton.onclick = function () {
        Cookies.set('cookie-box', true, {
          expires:  2 
    });
    cookieBox.classList.add('cookie-box-hide');
  };
		}
	}) (jQuery);
</script>


<style>
  .cookie-box {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    text-align: center;
    z-index: 9999;
    padding: 1rem 2rem;
    background: rgb(71, 71, 71);
    transition: all .75s cubic-bezier(.19, 1, .22, 1);
    color: #fdfdfd;
  }

  .cookie-box-hide {
    display: none;
  }
</style>
</body>
</html>